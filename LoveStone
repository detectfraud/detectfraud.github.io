<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–°–≤—è—â–µ–Ω–Ω–∏–π –∫–∞–º—ñ–Ω—å –¥–ª—è –∑–∞–∫–æ—Ö–∞–Ω–∏—Ö</title>
  <style>
   /* body { font-family: Arial, sans-serif; text-align: center; }*/
    canvas { border: 2px solid #666; margin-top: 15px; }
    input, button { margin: 8px; padding: 6px 10px; }
  </style>
</head>
<body>
  <h2>–°–≤—è—â–µ–Ω–Ω–∏–π –∫–∞–º—ñ–Ω—å –¥–ª—è –∑–∞–∫–æ—Ö–∞–Ω–∏—Ö üíû</h2>
 <br><br> 
 <canvas id="canvas" width="630" height="420"></canvas>
  <label>–§–æ—Ç–æ –∑–∞–∫–æ—Ö–∞–Ω–∏—Ö:
    <input type="file" id="coupleInput" accept="image/*">
  </label><br>

  <label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;–§–æ–Ω:
    <input type="file" id="backgroundInput" accept="image/*">
  </label><br>

  <button id="generate">–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ñ–æ—Ç–æ</button>
  <button id="download">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button>

 

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    // —à–∞–±–ª–æ–Ω –∑ –∫–∞–º–µ–Ω–µ–º
    const sculpture = new Image();
    sculpture.src = "–ö–∞–º–µ–Ω—å –ª—é–±–≤–∏ —à–∞–±–ª–æ–Ω.jpg";

    let coupleImg = null;
    let bgImg = null;

    // –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ –∑–∞–∫–æ—Ö–∞–Ω–∏—Ö
    document.getElementById("coupleInput").addEventListener("change", e => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = ev => {
          coupleImg = new Image();
          coupleImg.src = ev.target.result;
        };
        reader.readAsDataURL(file);
      }
    });

    // –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ–Ω—É
    document.getElementById("backgroundInput").addEventListener("change", e => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = ev => {
          bgImg = new Image();
          bgImg.src = ev.target.result;
        };
        reader.readAsDataURL(file);
      }
    });

    // –º–∞–ª—é–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
    function drawResult() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // 1. —Ñ–æ–Ω
      if (bgImg) ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);

      // 2. —Ñ–æ—Ç–æ –∑–∞–∫–æ—Ö–∞–Ω–∏—Ö —É –∫–æ–ª—ñ
      if (coupleImg) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(450, 210, 150, 0, Math.PI * 2); // —Ü–µ–Ω—Ç—Ä —ñ —Ä–∞–¥—ñ—É—Å –∫–æ–ª–∞
        ctx.closePath();
        ctx.clip();

        // –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è —Ñ–æ—Ç–æ –∑–∞–∫–æ—Ö–∞–Ω–∏—Ö –ø—ñ–¥ –æ—Ç–≤—ñ—Ä  
        ctx.drawImage(coupleImg, 280, 40, 340, 340);   ctx.restore(); }
       
     

      // 3. –Ω–∞–∫–ª–∞–¥–∞—î–º–æ —Å–∫—É–ª—å–ø—Ç—É—Ä—É
      ctx.drawImage(sculpture, 0, 0, canvas.width, canvas.height);
    }
    
    // –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
    document.getElementById("download").addEventListener("click", () => {
      const link = document.createElement("a");
      link.download = "love-stone.png";
      link.href = canvas.toDataURL("image/png");
      link.click();
    });
    
    document.getElementById("generate").addEventListener("click", drawResult);


  </script>
</body>
</html>
